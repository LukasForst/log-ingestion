sources:
  file_logs:
    type: "file"
    include:
      - "/var/log/shared/app.log"
    ignore_older_secs: 600

transforms:
  add_timestamp:
    type: "remap"
    inputs:
      - "file_logs"
    source: |
      .timestamp = to_unix_timestamp(now(), unit: "milliseconds")
      .message = string!(.message)

sinks:
  kafka_out:
    type: "kafka"
    inputs:
      - "add_timestamp"
    bootstrap_servers: "redpanda:9092"
    topic: "app_logs"
    encoding:
      codec: "json"
